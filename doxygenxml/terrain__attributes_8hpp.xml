<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.13">
  <compounddef id="terrain__attributes_8hpp" kind="file" language="C++">
    <compoundname>terrain_attributes.hpp</compoundname>
    <includes refid="logger_8hpp" local="yes">richdem/common/logger.hpp</includes>
    <includes refid="Array2D_8hpp" local="yes">richdem/common/Array2D.hpp</includes>
    <includes refid="constants_8hpp" local="yes">richdem/common/constants.hpp</includes>
    <includes refid="ProgressBar_8hpp" local="yes">richdem/common/ProgressBar.hpp</includes>
    <includedby refid="richdem_8hpp" local="yes">/z/richdem/include/richdem/richdem.hpp</includedby>
    <incdepgraph>
      <node id="1009">
        <label>richdem/common/ProgressBar.hpp</label>
        <link refid="ProgressBar_8hpp"/>
        <childnode refid="991" relation="include">
        </childnode>
        <childnode refid="989" relation="include">
        </childnode>
        <childnode refid="996" relation="include">
        </childnode>
        <childnode refid="1010" relation="include">
        </childnode>
        <childnode refid="1000" relation="include">
        </childnode>
        <childnode refid="1011" relation="include">
        </childnode>
      </node>
      <node id="996">
        <label>iomanip</label>
      </node>
      <node id="1001">
        <label>limits</label>
      </node>
      <node id="997">
        <label>cassert</label>
      </node>
      <node id="1000">
        <label>stdexcept</label>
      </node>
      <node id="991">
        <label>string</label>
      </node>
      <node id="992">
        <label>richdem/common/Array2D.hpp</label>
        <link refid="Array2D_8hpp"/>
        <childnode refid="993" relation="include">
        </childnode>
        <childnode refid="994" relation="include">
        </childnode>
        <childnode refid="989" relation="include">
        </childnode>
        <childnode refid="995" relation="include">
        </childnode>
        <childnode refid="996" relation="include">
        </childnode>
        <childnode refid="997" relation="include">
        </childnode>
        <childnode refid="998" relation="include">
        </childnode>
        <childnode refid="999" relation="include">
        </childnode>
        <childnode refid="1000" relation="include">
        </childnode>
        <childnode refid="1001" relation="include">
        </childnode>
        <childnode refid="1002" relation="include">
        </childnode>
        <childnode refid="1003" relation="include">
        </childnode>
        <childnode refid="1004" relation="include">
        </childnode>
        <childnode refid="988" relation="include">
        </childnode>
        <childnode refid="1005" relation="include">
        </childnode>
        <childnode refid="1006" relation="include">
        </childnode>
        <childnode refid="1007" relation="include">
        </childnode>
      </node>
      <node id="1004">
        <label>map</label>
      </node>
      <node id="1003">
        <label>unordered_set</label>
      </node>
      <node id="995">
        <label>fstream</label>
      </node>
      <node id="999">
        <label>typeinfo</label>
      </node>
      <node id="1005">
        <label>richdem/common/version.hpp</label>
        <link refid="version_8hpp"/>
        <childnode refid="991" relation="include">
        </childnode>
        <childnode refid="989" relation="include">
        </childnode>
      </node>
      <node id="1002">
        <label>ctime</label>
      </node>
      <node id="994">
        <label>vector</label>
      </node>
      <node id="990">
        <label>sstream</label>
      </node>
      <node id="987">
        <label>/z/richdem/include/richdem/methods/terrain_attributes.hpp</label>
        <link refid="terrain__attributes_8hpp"/>
        <childnode refid="988" relation="include">
        </childnode>
        <childnode refid="992" relation="include">
        </childnode>
        <childnode refid="1006" relation="include">
        </childnode>
        <childnode refid="1009" relation="include">
        </childnode>
      </node>
      <node id="1010">
        <label>sys/time.h</label>
      </node>
      <node id="989">
        <label>iostream</label>
      </node>
      <node id="1007">
        <label>richdem/common/ManagedVector.hpp</label>
        <link refid="ManagedVector_8hpp_source"/>
        <childnode refid="1008" relation="include">
        </childnode>
      </node>
      <node id="993">
        <label>gdal.hpp</label>
        <link refid="gdal_8hpp_source"/>
      </node>
      <node id="1011">
        <label>richdem/common/timer.hpp</label>
        <link refid="timer_8hpp"/>
        <childnode refid="1010" relation="include">
        </childnode>
        <childnode refid="1000" relation="include">
        </childnode>
      </node>
      <node id="1006">
        <label>richdem/common/constants.hpp</label>
        <link refid="constants_8hpp"/>
      </node>
      <node id="998">
        <label>algorithm</label>
      </node>
      <node id="1008">
        <label>memory</label>
      </node>
      <node id="988">
        <label>richdem/common/logger.hpp</label>
        <link refid="logger_8hpp_source"/>
        <childnode refid="989" relation="include">
        </childnode>
        <childnode refid="990" relation="include">
        </childnode>
        <childnode refid="991" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="1013">
        <label>/z/richdem/include/richdem/richdem.hpp</label>
        <link refid="richdem_8hpp_source"/>
      </node>
      <node id="1012">
        <label>/z/richdem/include/richdem/methods/terrain_attributes.hpp</label>
        <link refid="terrain__attributes_8hpp"/>
        <childnode refid="1013" relation="include">
        </childnode>
      </node>
    </invincdepgraph>
    <innerclass refid="classrichdem_1_1TA__Setup__Vars" prot="public">richdem::TA_Setup_Vars</innerclass>
    <innerclass refid="classrichdem_1_1TA__Setup__Curves__Vars" prot="public">richdem::TA_Setup_Curves_Vars</innerclass>
    <innernamespace refid="namespacerichdem">richdem</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>_richdem_terrain_attributes_hpp_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_richdem_terrain_attributes_hpp_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;richdem/common/logger.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="Array2D_8hpp" kindref="compound">richdem/common/Array2D.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="constants_8hpp" kindref="compound">richdem/common/constants.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ProgressBar_8hpp" kindref="compound">richdem/common/ProgressBar.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacerichdem" kindref="compound">richdem</ref><sp/>{</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">//d8_SPI</highlight></codeline>
<codeline lineno="29"><highlight class="comment"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>U,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>V&gt;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_SPI(</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>Array2D&lt;T&gt;<sp/>&amp;flow_accumulation,</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>Array2D&lt;U&gt;<sp/>&amp;riserun_slope,</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Array2D&lt;V&gt;<sp/>&amp;result</highlight></codeline>
<codeline lineno="34"><highlight class="normal">){</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/>Timer<sp/>timer;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;d8_SPI&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//TODO:<sp/>CITATION</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(flow_accumulation.width()!=riserun_slope.width()<sp/>||<sp/>flow_accumulation.height()!=riserun_slope.height())</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::runtime_error(</highlight><highlight class="stringliteral">&quot;Couldn&apos;t<sp/>calculate<sp/>SPI!<sp/>The<sp/>input<sp/>matricies<sp/>were<sp/>of<sp/>unequal<sp/>dimensions!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/>RDLOG_PROGRESS&lt;&lt;</highlight><highlight class="stringliteral">&quot;Setting<sp/>up<sp/>the<sp/>SPI<sp/>matrix...&quot;</highlight><highlight class="normal">&lt;&lt;std::flush;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/>result.resize(flow_accumulation);</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/>result.setNoData(-1);<sp/><sp/></highlight><highlight class="comment">//Log(x)<sp/>can&apos;t<sp/>take<sp/>this<sp/>value<sp/>of<sp/>real<sp/>inputs,<sp/>so<sp/>we&apos;re<sp/>good</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/>RDLOG_PROGRESS&lt;&lt;</highlight><highlight class="stringliteral">&quot;Calculating<sp/>SPI...&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/>timer.start();</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for<sp/>collapse(2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x=0;x&lt;flow_accumulation.width();x++)</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y=0;y&lt;flow_accumulation.height();y++)</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(flow_accumulation(x,y)==flow_accumulation.noData()<sp/>||<sp/>riserun_slope(x,y)==riserun_slope.noData())</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result(x,y)=result.noData();</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result(x,y)=log(<sp/>(flow_accumulation(x,y)/flow_accumulation.getCellArea())<sp/>*<sp/>(riserun_slope(x,y)+0.001)<sp/>);</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/>RDLOG_TIME_USE&lt;&lt;</highlight><highlight class="stringliteral">&quot;succeeded<sp/>in<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;timer.stop()&lt;&lt;</highlight><highlight class="stringliteral">&quot;s.&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="57"><highlight class="normal">}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="comment">//d8_CTI</highlight></codeline>
<codeline lineno="81"><highlight class="comment"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>U,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>V&gt;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_CTI(</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>Array2D&lt;T&gt;<sp/>&amp;flow_accumulation,</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>Array2D&lt;U&gt;<sp/>&amp;riserun_slope,</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Array2D&lt;V&gt;<sp/>&amp;result</highlight></codeline>
<codeline lineno="86"><highlight class="normal">){</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/>Timer<sp/>timer;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;d8_CTI&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(flow_accumulation.width()!=riserun_slope.width()<sp/>||<sp/>flow_accumulation.height()!=riserun_slope.height())</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::runtime_error(</highlight><highlight class="stringliteral">&quot;Couldn&apos;t<sp/>calculate<sp/>CTI!<sp/>The<sp/>input<sp/>matricies<sp/>were<sp/>of<sp/>unequal<sp/>dimensions!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/>RDLOG_PROGRESS&lt;&lt;</highlight><highlight class="stringliteral">&quot;Setting<sp/>up<sp/>the<sp/>CTI<sp/>matrix...&quot;</highlight><highlight class="normal">&lt;&lt;std::flush;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/>result.resize(flow_accumulation);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/>result.setNoData(-1);<sp/><sp/></highlight><highlight class="comment">//Log(x)<sp/>can&apos;t<sp/>take<sp/>this<sp/>value<sp/>of<sp/>real<sp/>inputs,<sp/>so<sp/>we&apos;re<sp/>good</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/>RDLOG_PROGRESS&lt;&lt;</highlight><highlight class="stringliteral">&quot;succeeded.&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/>RDLOG_PROGRESS&lt;&lt;</highlight><highlight class="stringliteral">&quot;Calculating<sp/>CTI...&quot;</highlight><highlight class="normal">&lt;&lt;std::flush;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/>timer.start();</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for<sp/>collapse(2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x=0;x&lt;flow_accumulation.width();x++)</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y=0;y&lt;flow_accumulation.height();y++)</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(flow_accumulation(x,y)==flow_accumulation.noData()<sp/>||<sp/>riserun_slope(x,y)==riserun_slope.noData())</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result(x,y)=result.noData();</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result(x,y)=log(<sp/>(flow_accumulation(x,y)/flow_accumulation.getCellArea())<sp/>/<sp/>(riserun_slope(x,y)+0.001)<sp/>);</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/>RDLOG_TIME_USE&lt;&lt;</highlight><highlight class="stringliteral">&quot;succeeded<sp/>in<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;timer.stop()&lt;&lt;</highlight><highlight class="stringliteral">&quot;s.&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="109"><highlight class="normal">}</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight><highlight class="comment">//d8_terrain_attrib_helper</highlight></codeline>
<codeline lineno="144" refid="classrichdem_1_1TA__Setup__Vars" refkind="compound"><highlight class="comment"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classrichdem_1_1TA__Setup__Vars" kindref="compound">TA_Setup_Vars</ref><sp/>{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>a,b,c,d,e,f,g,h,i;</highlight></codeline>
<codeline lineno="147"><highlight class="normal">};</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149" refid="classrichdem_1_1TA__Setup__Curves__Vars" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classrichdem_1_1TA__Setup__Curves__Vars" kindref="compound">TA_Setup_Curves_Vars</ref><sp/>{</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>L,D,E,F,G,H;</highlight></codeline>
<codeline lineno="152"><highlight class="normal">};</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="157"><highlight class="comment">Slope<sp/>derived<sp/>from<sp/>ArcGIS<sp/>help<sp/>at:</highlight></codeline>
<codeline lineno="158"><highlight class="comment">http://webhelp.esri.com/arcgiSDEsktop/9.3/index.cfm?TopicName=How%20Slope%20works</highlight></codeline>
<codeline lineno="159"><highlight class="comment">http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#/How_Slope_works/009z000000vz000000/</highlight></codeline>
<codeline lineno="160"><highlight class="comment"></highlight></codeline>
<codeline lineno="161"><highlight class="comment">Cells<sp/>are<sp/>identified<sp/>as</highlight></codeline>
<codeline lineno="162"><highlight class="comment">Aspect<sp/>derived<sp/>from<sp/>AcrGIS<sp/>help<sp/>at:</highlight></codeline>
<codeline lineno="163"><highlight class="comment">http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#/How_Aspect_works/00q900000023000000/</highlight></codeline>
<codeline lineno="164"><highlight class="comment">http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#/How_Aspect_works/009z000000vp000000/</highlight></codeline>
<codeline lineno="165"><highlight class="comment"></highlight></codeline>
<codeline lineno="166"><highlight class="comment">Curvature<sp/>dervied<sp/>from<sp/>ArcGIS<sp/>help<sp/>at:</highlight></codeline>
<codeline lineno="167"><highlight class="comment">http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//00q90000000t000000</highlight></codeline>
<codeline lineno="168"><highlight class="comment">http://blogs.esri.com/esri/arcgis/2010/10/27/understanding-curvature-rasters/</highlight></codeline>
<codeline lineno="169"><highlight class="comment"></highlight></codeline>
<codeline lineno="170"><highlight class="comment">Expanded<sp/>ArcGIS<sp/>curvature<sp/>info</highlight></codeline>
<codeline lineno="171"><highlight class="comment">http://support.esri.com/en/knowledgebase/techarticles/detail/21942</highlight></codeline>
<codeline lineno="172"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight><highlight class="comment">//a<sp/>b<sp/>c</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight><highlight class="comment">//d<sp/>e<sp/>f</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight><highlight class="comment">//g<sp/>h<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight><highlight class="comment">//Deal<sp/>with<sp/>grid<sp/>edges<sp/>and<sp/>NoData<sp/>values<sp/>in<sp/>the<sp/>manner<sp/>suggested<sp/>by</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight><highlight class="comment">//ArcGIS.<sp/>Note<sp/>that<sp/>this<sp/>function<sp/>should<sp/>never<sp/>be<sp/>called<sp/>on<sp/>a<sp/>NoData<sp/>cell</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1TA__Setup__Vars" kindref="compound">TA_Setup_Vars</ref><sp/>TerrainSetup(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1TA__Setup__Vars" kindref="compound">TA_Setup_Vars</ref><sp/>tsv;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/>tsv.a=tsv.b=tsv.c=tsv.d=tsv.e=tsv.f=tsv.g=tsv.h=tsv.i=elevations(x,y);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1abf160c36c4e75a94e959c0e77472989c" kindref="member">inGrid</ref>(x-1,y-1)<sp/>&amp;&amp;<sp/>elevations(x-1,y-1)!=elevations.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>())<sp/>tsv.a<sp/>=<sp/>elevations(x-1,y-1);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1abf160c36c4e75a94e959c0e77472989c" kindref="member">inGrid</ref>(x-1,y<sp/><sp/>)<sp/>&amp;&amp;<sp/>elevations(x-1,y<sp/><sp/>)!=elevations.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>())<sp/>tsv.d<sp/>=<sp/>elevations(x-1,y<sp/><sp/>);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1abf160c36c4e75a94e959c0e77472989c" kindref="member">inGrid</ref>(x-1,y+1)<sp/>&amp;&amp;<sp/>elevations(x-1,y+1)!=elevations.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>())<sp/>tsv.g<sp/>=<sp/>elevations(x-1,y+1);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1abf160c36c4e75a94e959c0e77472989c" kindref="member">inGrid</ref>(x<sp/><sp/>,y-1)<sp/>&amp;&amp;<sp/>elevations(x,<sp/><sp/>y-1)!=elevations.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>())<sp/>tsv.b<sp/>=<sp/>elevations(x,<sp/><sp/>y-1);</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1abf160c36c4e75a94e959c0e77472989c" kindref="member">inGrid</ref>(x<sp/><sp/>,y+1)<sp/>&amp;&amp;<sp/>elevations(x,<sp/><sp/>y+1)!=elevations.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>())<sp/>tsv.h<sp/>=<sp/>elevations(x,<sp/><sp/>y+1);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1abf160c36c4e75a94e959c0e77472989c" kindref="member">inGrid</ref>(x+1,y-1)<sp/>&amp;&amp;<sp/>elevations(x+1,y-1)!=elevations.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>())<sp/>tsv.c<sp/>=<sp/>elevations(x+1,y-1);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1abf160c36c4e75a94e959c0e77472989c" kindref="member">inGrid</ref>(x+1,y<sp/><sp/>)<sp/>&amp;&amp;<sp/>elevations(x+1,y<sp/><sp/>)!=elevations.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>())<sp/>tsv.f<sp/>=<sp/>elevations(x+1,y<sp/><sp/>);</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1abf160c36c4e75a94e959c0e77472989c" kindref="member">inGrid</ref>(x+1,y+1)<sp/>&amp;&amp;<sp/>elevations(x+1,y+1)!=elevations.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>())<sp/>tsv.i<sp/>=<sp/>elevations(x+1,y+1);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/>tsv.a<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/>tsv.b<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/>tsv.c<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/>tsv.d<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/>tsv.e<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/>tsv.f<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/>tsv.g<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/>tsv.h<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/>tsv.i<sp/>*=<sp/>zscale;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tsv;</highlight></codeline>
<codeline lineno="204"><highlight class="normal">}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1TA__Setup__Curves__Vars" kindref="compound">TA_Setup_Curves_Vars</ref><sp/>TerrainCurvatureSetup(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1TA__Setup__Vars" kindref="compound">TA_Setup_Vars</ref><sp/>tsv<sp/>=<sp/>TerrainSetup(elevations,<sp/>x,<sp/>y,<sp/>zscale);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1TA__Setup__Curves__Vars" kindref="compound">TA_Setup_Curves_Vars</ref><sp/>tscv;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Z1<sp/>Z2<sp/>Z3<sp/><sp/><sp/>a<sp/>b<sp/>c</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Z4<sp/>Z5<sp/>Z6<sp/><sp/><sp/>d<sp/>e<sp/>f</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Z7<sp/>Z8<sp/>Z9<sp/><sp/><sp/>g<sp/>h<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Curvatures<sp/>in<sp/>the<sp/>manner<sp/>of<sp/>Zevenbergen<sp/>and<sp/>Thorne<sp/>1987</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/>tscv.L<sp/><sp/>=<sp/>elevations.<ref refid="classrichdem_1_1Array2D_1a33fb7dde408a1d4a49f6411417b4d725" kindref="member">getCellLengthX</ref>();</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/>tscv.D<sp/><sp/>=<sp/>(<sp/>(tsv.d+tsv.f)/2<sp/>-<sp/>tsv.e)<sp/>/<sp/>tscv.L<sp/>/<sp/>tscv.L;<sp/><sp/></highlight><highlight class="comment">//D<sp/>=<sp/>[(Z4<sp/>+<sp/>Z6)<sp/>/2<sp/>-<sp/>Z5]<sp/>/<sp/>L^2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/>tscv.E<sp/><sp/>=<sp/>(<sp/>(tsv.b+tsv.h)/2<sp/>-<sp/>tsv.e)<sp/>/<sp/>tscv.L<sp/>/<sp/>tscv.L;<sp/><sp/></highlight><highlight class="comment">//E<sp/>=<sp/>[(Z2<sp/>+<sp/>Z8)<sp/>/2<sp/>-<sp/>Z5]<sp/>/<sp/>L^2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/>tscv.F<sp/><sp/>=<sp/>(-tsv.a+tsv.c+tsv.g-tsv.i)/4/tscv.L/tscv.L;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//F<sp/>=<sp/>(-Z1+Z3+Z7-Z9)/(4L^2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/>tscv.G<sp/><sp/>=<sp/>(-tsv.d+tsv.f)/2/tscv.L;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//G<sp/>=<sp/>(-Z4+Z6)/(2L)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/>tscv.H<sp/><sp/>=<sp/>(tsv.b-tsv.h)/2/tscv.L;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//H<sp/>=<sp/>(Z2-Z8)/(2L)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tscv;</highlight></codeline>
<codeline lineno="224"><highlight class="normal">}</highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="comment">//ArcGIS<sp/>doesn&apos;t<sp/>use<sp/>cell<sp/>size<sp/>for<sp/>aspect<sp/>calculations.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Terrain_Aspect(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>tsv<sp/>=<sp/>TerrainSetup(elevations,x,y,zscale);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//See<sp/>p.<sp/>18<sp/>of<sp/>Horn<sp/>(1981)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dzdx<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>(<sp/>(tsv.c+2*tsv.f+tsv.i)<sp/>-<sp/>(tsv.a+2*tsv.d+tsv.g)<sp/>)<sp/>/<sp/>8<sp/>/<sp/>elevations.<ref refid="classrichdem_1_1Array2D_1a33fb7dde408a1d4a49f6411417b4d725" kindref="member">getCellLengthX</ref>();</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dzdy<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>(<sp/>(tsv.g+2*tsv.h+tsv.i)<sp/>-<sp/>(tsv.a+2*tsv.b+tsv.c)<sp/>)<sp/>/<sp/>8<sp/>/<sp/>elevations.<ref refid="classrichdem_1_1Array2D_1a826b748b165583ae5d19aef06b8cbaf6" kindref="member">getCellLengthY</ref>();</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>the_aspect<sp/>=<sp/>180.0/M_PI*atan2(dzdy,-dzdx);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(the_aspect&lt;0)</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>90-the_aspect;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(the_aspect&gt;90.0)</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>360.0-the_aspect+90.0;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>90.0-the_aspect;</highlight></codeline>
<codeline lineno="243"><highlight class="normal">}</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Terrain_Slope_RiseRun(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>tsv<sp/>=<sp/>TerrainSetup(elevations,x,y,zscale);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//See<sp/>p.<sp/>18<sp/>of<sp/>Horn<sp/>(1981)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dzdx<sp/>=<sp/>(<sp/>(tsv.c+2*tsv.f+tsv.i)<sp/>-<sp/>(tsv.a+2*tsv.d+tsv.g)<sp/>)<sp/>/<sp/>8<sp/>/<sp/>elevations.<ref refid="classrichdem_1_1Array2D_1a33fb7dde408a1d4a49f6411417b4d725" kindref="member">getCellLengthX</ref>();</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dzdy<sp/>=<sp/>(<sp/>(tsv.g+2*tsv.h+tsv.i)<sp/>-<sp/>(tsv.a+2*tsv.b+tsv.c)<sp/>)<sp/>/<sp/>8<sp/>/<sp/>elevations.<ref refid="classrichdem_1_1Array2D_1a826b748b165583ae5d19aef06b8cbaf6" kindref="member">getCellLengthY</ref>();</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//The<sp/>above<sp/>fits<sp/>are<sp/>surface<sp/>to<sp/>a<sp/>3x3<sp/>neighbour<sp/>hood.<sp/>This<sp/>returns<sp/>the<sp/>slope</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//along<sp/>the<sp/>direction<sp/>of<sp/>maximum<sp/>gradient.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sqrt(dzdx*dzdx+dzdy*dzdy);</highlight></codeline>
<codeline lineno="258"><highlight class="normal">}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Terrain_Curvature(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>tscv<sp/>=<sp/>TerrainCurvatureSetup(elevations,x,y,zscale);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(-2*(tscv.D+tscv.E)*100);</highlight></codeline>
<codeline lineno="265"><highlight class="normal">}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Terrain_Planform_Curvature(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>TerrainCurvatureSetup(elevations,x,y,zscale);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(p.G==0<sp/>&amp;&amp;<sp/>p.H==0)</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(-2*(p.D*p.H*p.H+p.E*p.G*p.G-p.F*p.G*p.H)/(p.G*p.G+p.H*p.H)*100);</highlight></codeline>
<codeline lineno="275"><highlight class="normal">}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Terrain_Profile_Curvature(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>TerrainCurvatureSetup(elevations,x,y,zscale);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(p.G==0<sp/>&amp;&amp;<sp/>p.H==0)</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(2*(p.D*p.G*p.G+p.E*p.H*p.H+p.F*p.G*p.H)/(p.G*p.G+p.H*p.H)*100);</highlight></codeline>
<codeline lineno="285"><highlight class="normal">}</highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Terrain_Slope_Percent(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Terrain_Slope_RiseRun(elevations,x,y,zscale)*100;</highlight></codeline>
<codeline lineno="290"><highlight class="normal">}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Terrain_Slope_Radian(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::atan(Terrain_Slope_RiseRun(elevations,x,y,zscale));</highlight></codeline>
<codeline lineno="295"><highlight class="normal">}</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Terrain_Slope_Degree(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale){</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::atan(Terrain_Slope_RiseRun(elevations,x,y,zscale))*180/M_PI;</highlight></codeline>
<codeline lineno="300"><highlight class="normal">}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>F,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TerrainProcessor(F<sp/>func,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale,<sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/>&amp;output){</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1a33fb7dde408a1d4a49f6411417b4d725" kindref="member">getCellLengthX</ref>()!=elevations.<ref refid="classrichdem_1_1Array2D_1a826b748b165583ae5d19aef06b8cbaf6" kindref="member">getCellLengthY</ref>())</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>RDLOG_WARN&lt;&lt;</highlight><highlight class="stringliteral">&quot;Cell<sp/>X<sp/>and<sp/>Y<sp/>dimensions<sp/>are<sp/>not<sp/>equal!&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/>output.<ref refid="classrichdem_1_1Array2D_1a4baf4116eb21f3588877dfd0d0613aa2" kindref="member">resize</ref>(elevations);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1ProgressBar" kindref="compound">ProgressBar</ref><sp/>progress;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/>progress.<ref refid="classrichdem_1_1ProgressBar_1a00e1878d9af52da7397d5965d923bbbd" kindref="member">start</ref>(elevations.<ref refid="classrichdem_1_1Array2D_1aa7c4661b81d89c5c8aaa549b105f63c5" kindref="member">size</ref>());</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y=0;y&lt;elevations.<ref refid="classrichdem_1_1Array2D_1ab2e27ec2c5986596760a5256d92a2eb0" kindref="member">height</ref>();y++){</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/>progress.<ref refid="classrichdem_1_1ProgressBar_1aa71fef0e8019c8dd64ed7c7e79466511" kindref="member">update</ref>(y*elevations.<ref refid="classrichdem_1_1Array2D_1ad4d72d15f5a6199631051038088bb306" kindref="member">width</ref>());</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x=0;x&lt;elevations.<ref refid="classrichdem_1_1Array2D_1ad4d72d15f5a6199631051038088bb306" kindref="member">width</ref>();x++)</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(elevations.<ref refid="classrichdem_1_1Array2D_1a2d89b410c05e05e7586bda960f4fafac" kindref="member">isNoData</ref>(x,y))</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output(x,y)<sp/>=<sp/>output.<ref refid="classrichdem_1_1Array2D_1a80cb5415f73417724bb7fee3da21303a" kindref="member">noData</ref>();</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output(x,y)<sp/>=<sp/>func(elevations,x,y,zscale);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/>RDLOG_TIME_USE&lt;&lt;</highlight><highlight class="stringliteral">&quot;Wall-time<sp/>=<sp/>&quot;</highlight><highlight class="normal">&lt;&lt;progress.<ref refid="classrichdem_1_1ProgressBar_1a69063c770d5eaee6299590de1d0294b6" kindref="member">stop</ref>();</highlight></codeline>
<codeline lineno="354"><highlight class="normal">}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_slope_riserun(</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/><sp/><sp/>&amp;slopes,</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale<sp/>=<sp/>1.0f</highlight></codeline>
<codeline lineno="374"><highlight class="normal">){</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;Slope<sp/>calculation<sp/>(rise/run)&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/>RDLOG_CITATION&lt;&lt;</highlight><highlight class="stringliteral">&quot;Horn,<sp/>B.K.P.,<sp/>1981.<sp/>Hill<sp/>shading<sp/>and<sp/>the<sp/>reflectance<sp/>map.<sp/>Proceedings<sp/>of<sp/>the<sp/>IEEE<sp/>69,<sp/>1447.<sp/>doi:10.1109/PROC.1981.11918&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/>TerrainProcessor(Terrain_Slope_RiseRun&lt;T&gt;,<sp/>elevations,<sp/>zscale,<sp/>slopes);</highlight></codeline>
<codeline lineno="378"><highlight class="normal">}</highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_slope_percentage(</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/><sp/><sp/>&amp;slopes,</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale<sp/>=<sp/>1.0f</highlight></codeline>
<codeline lineno="396"><highlight class="normal">){</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;Slope<sp/>calculation<sp/>(percenage)&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/>RDLOG_CITATION&lt;&lt;</highlight><highlight class="stringliteral">&quot;Horn,<sp/>B.K.P.,<sp/>1981.<sp/>Hill<sp/>shading<sp/>and<sp/>the<sp/>reflectance<sp/>map.<sp/>Proceedings<sp/>of<sp/>the<sp/>IEEE<sp/>69,<sp/>1447.<sp/>doi:10.1109/PROC.1981.11918&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/>TerrainProcessor(Terrain_Slope_Percent&lt;T&gt;,<sp/>elevations,<sp/>zscale,<sp/>slopes);</highlight></codeline>
<codeline lineno="400"><highlight class="normal">}</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_slope_degrees(</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/><sp/><sp/>&amp;slopes,</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale<sp/>=<sp/>1.0f</highlight></codeline>
<codeline lineno="418"><highlight class="normal">){</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;Slope<sp/>calculation<sp/>(degrees)&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/>RDLOG_CITATION&lt;&lt;</highlight><highlight class="stringliteral">&quot;Horn,<sp/>B.K.P.,<sp/>1981.<sp/>Hill<sp/>shading<sp/>and<sp/>the<sp/>reflectance<sp/>map.<sp/>Proceedings<sp/>of<sp/>the<sp/>IEEE<sp/>69,<sp/>1447.<sp/>doi:10.1109/PROC.1981.11918&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/>TerrainProcessor(Terrain_Slope_Degree&lt;T&gt;,<sp/>elevations,<sp/>zscale,<sp/>slopes);</highlight></codeline>
<codeline lineno="422"><highlight class="normal">}</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_slope_radians(</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/><sp/><sp/>&amp;slopes,</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale<sp/>=<sp/>1.0f</highlight></codeline>
<codeline lineno="440"><highlight class="normal">){</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;Slope<sp/>calculation<sp/>(radians)&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/>RDLOG_CITATION&lt;&lt;</highlight><highlight class="stringliteral">&quot;Horn,<sp/>B.K.P.,<sp/>1981.<sp/>Hill<sp/>shading<sp/>and<sp/>the<sp/>reflectance<sp/>map.<sp/>Proceedings<sp/>of<sp/>the<sp/>IEEE<sp/>69,<sp/>1447.<sp/>doi:10.1109/PROC.1981.11918&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/>TerrainProcessor(Terrain_Slope_Radian&lt;T&gt;,<sp/>elevations,<sp/>zscale,<sp/>slopes);</highlight></codeline>
<codeline lineno="444"><highlight class="normal">}</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_aspect(</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/><sp/><sp/>&amp;aspects,</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale<sp/>=<sp/>1.0f</highlight></codeline>
<codeline lineno="463"><highlight class="normal">){</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;Aspect<sp/>attribute<sp/>calculation&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/>RDLOG_CITATION&lt;&lt;</highlight><highlight class="stringliteral">&quot;Horn,<sp/>B.K.P.,<sp/>1981.<sp/>Hill<sp/>shading<sp/>and<sp/>the<sp/>reflectance<sp/>map.<sp/>Proceedings<sp/>of<sp/>the<sp/>IEEE<sp/>69,<sp/>1447.<sp/>doi:10.1109/PROC.1981.11918&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/>TerrainProcessor(Terrain_Aspect&lt;T&gt;,<sp/>elevations,<sp/>zscale,<sp/>aspects);</highlight></codeline>
<codeline lineno="467"><highlight class="normal">}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_curvature(</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,<sp/></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/><sp/><sp/>&amp;curvatures,<sp/></highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale<sp/>=<sp/>1.0f</highlight></codeline>
<codeline lineno="485"><highlight class="normal">){</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;Curvature<sp/>attribute<sp/>calculation&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/>RDLOG_CITATION&lt;&lt;</highlight><highlight class="stringliteral">&quot;Zevenbergen,<sp/>L.W.,<sp/>Thorne,<sp/>C.R.,<sp/>1987.<sp/>Quantitative<sp/>analysis<sp/>of<sp/>land<sp/>surface<sp/>topography.<sp/>Earth<sp/>surface<sp/>processes<sp/>and<sp/>landforms<sp/>12,<sp/>4756.&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/>TerrainProcessor(Terrain_Curvature&lt;T&gt;,<sp/>elevations,<sp/>zscale,<sp/>curvatures);</highlight></codeline>
<codeline lineno="489"><highlight class="normal">}</highlight></codeline>
<codeline lineno="490"><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_planform_curvature(</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/><sp/><sp/>&amp;planform_curvatures,</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale<sp/>=<sp/>1.0f</highlight></codeline>
<codeline lineno="508"><highlight class="normal">){</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;Planform<sp/>curvature<sp/>attribute<sp/>calculation&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/>RDLOG_CITATION&lt;&lt;</highlight><highlight class="stringliteral">&quot;Zevenbergen,<sp/>L.W.,<sp/>Thorne,<sp/>C.R.,<sp/>1987.<sp/>Quantitative<sp/>analysis<sp/>of<sp/>land<sp/>surface<sp/>topography.<sp/>Earth<sp/>surface<sp/>processes<sp/>and<sp/>landforms<sp/>12,<sp/>4756.&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/>TerrainProcessor(Terrain_Planform_Curvature&lt;T&gt;,<sp/>elevations,<sp/>zscale,<sp/>planform_curvatures);</highlight></codeline>
<codeline lineno="512"><highlight class="normal">}</highlight></codeline>
<codeline lineno="513"><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>TA_profile_curvature(</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;T&gt;</ref><sp/>&amp;elevations,</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><ref refid="classrichdem_1_1Array2D" kindref="compound">Array2D&lt;float&gt;</ref><sp/><sp/><sp/>&amp;profile_curvatures,</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>zscale<sp/>=<sp/>1.0f</highlight></codeline>
<codeline lineno="530"><highlight class="normal">){</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/>RDLOG_ALG_NAME&lt;&lt;</highlight><highlight class="stringliteral">&quot;Profile<sp/>curvature<sp/>attribute<sp/>calculation&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/>RDLOG_CITATION&lt;&lt;</highlight><highlight class="stringliteral">&quot;Zevenbergen,<sp/>L.W.,<sp/>Thorne,<sp/>C.R.,<sp/>1987.<sp/>Quantitative<sp/>analysis<sp/>of<sp/>land<sp/>surface<sp/>topography.<sp/>Earth<sp/>surface<sp/>processes<sp/>and<sp/>landforms<sp/>12,<sp/>4756.&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/>TerrainProcessor(Terrain_Profile_Curvature&lt;T&gt;,<sp/>elevations,<sp/>zscale,<sp/>profile_curvatures);</highlight></codeline>
<codeline lineno="534"><highlight class="normal">}</highlight></codeline>
<codeline lineno="535"><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal">}</highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
    </programlisting>
    <location file="/z/richdem/include/richdem/methods/terrain_attributes.hpp"/>
  </compounddef>
</doxygen>
