

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Python Examples &mdash; RichDEM 0.0.03 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="RichDEM 0.0.03 documentation" href="index.html"/>
        <link rel="next" title="RichDEM C++ Reference" href="cpp_api.html"/>
        <link rel="prev" title="Terrain Attributes" href="terrain_attributes.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> RichDEM
          

          
          </a>

          
            
            
              <div class="version">
                0.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">RichDEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html">Design Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="parsable_output.html">Parsable Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="citations.html">Citing RichDEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_it.html">Ways To Use It</a></li>
</ul>
<p class="caption"><span class="caption-text">Operations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_dems.html">Example DEMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="loading_data.html">Loading Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="depression_filling.html">Depression-Filling</a></li>
<li class="toctree-l1"><a class="reference internal" href="flow_metrics.html">Flow Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="flow_metrics.html#side-by-side-comparisons-of-flow-metrics">Side-by-Side Comparisons of Flow Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="flow_accumulation.html">Flow Accumulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="terrain_attributes.html">Terrain Attributes</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#depression-filling-a-dem-and-saving-it">Depression-filling a DEM and saving it</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-filled-vs-unfilled-dems">Comparing filled vs. unfilled DEMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-rdarray-class">The rdarray class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-richdem-without-gdal">Using RichDEM without GDAL</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cpp_api.html">RichDEM C++ Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api.html">RichDEM Python Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing and Correctness</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="testcorrect.html">Testing Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="testcorrect.html#correctness">Correctness</a></li>
</ul>
<p class="caption"><span class="caption-text">Extra Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Specific Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html#publications">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="sponsors.html">Sponsors</a></li>
<li class="toctree-l1"><a class="reference internal" href="feedback.html">Feedback</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RichDEM</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Python Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples_python.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="python-examples">
<h1>Python Examples<a class="headerlink" href="#python-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="depression-filling-a-dem-and-saving-it">
<h2>Depression-filling a DEM and saving it<a class="headerlink" href="#depression-filling-a-dem-and-saving-it" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">richdem</span> <span class="kn">as</span> <span class="nn">rd</span>

<span class="c1">#Load DEM</span>
<span class="n">dem</span>     <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">LoadGDAL</span><span class="p">(</span><span class="s2">&quot;mydem.tif&quot;</span><span class="p">)</span>

<span class="c1">#Fill depressions in the DEM. The data is modified in-place to avoid making</span>
<span class="c1">#an unnecessary copy. This saves both time and RAM. Note that the function</span>
<span class="c1">#has no return value when `in_place=True`.</span>
<span class="n">rd</span><span class="o">.</span><span class="n">FillDepressions</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1">#Save the DEM</span>
<span class="n">rd</span><span class="o">.</span><span class="n">SaveGDAL</span><span class="p">(</span><span class="s2">&quot;mydem_filled.tif&quot;</span><span class="p">,</span> <span class="n">dem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="comparing-filled-vs-unfilled-dems">
<h2>Comparing filled vs. unfilled DEMs<a class="headerlink" href="#comparing-filled-vs-unfilled-dems" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">richdem</span> <span class="kn">as</span> <span class="nn">rd</span>

<span class="c1">#Load DEM</span>
<span class="n">dem</span>     <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">LoadGDAL</span><span class="p">(</span><span class="s2">&quot;mydem.tif&quot;</span><span class="p">)</span>

<span class="c1">#Copy the DEM so we can compare the altered DEM to the unaltered original</span>
<span class="n">demorig</span> <span class="o">=</span> <span class="n">dem</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">#Fill depressions in the DEM. The data is modified in place, but, since we</span>
<span class="c1">#made a copy above neither time nor memory is really saved.</span>
<span class="n">rd</span><span class="o">.</span><span class="n">FillDepressions</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1">#Get the difference of the filled and unfilled DEM</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">dem</span> <span class="o">-</span> <span class="n">demorig</span>

<span class="c1">#Display the difference. Do not plot values where there was no difference.</span>
<span class="n">rd</span><span class="o">.</span><span class="n">rdShow</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">ignore_colours</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>The foregoing could be written more succinctly by using <code class="xref cpp cpp-any docutils literal"><span class="pre">in_place=False</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">richdem</span> <span class="kn">as</span> <span class="nn">rd</span>

<span class="c1">#Load DEM</span>
<span class="n">demorig</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">LoadGDAL</span><span class="p">(</span><span class="s2">&quot;mydem.tif&quot;</span><span class="p">)</span>

<span class="c1">#Fill depressions in the DEM. By using `in_place=False`, a copy of the DEM</span>
<span class="c1">#is made and only this copy is altered. Note that the function now has a</span>
<span class="c1">#return value.</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">FillDepressions</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="the-rdarray-class">
<h2>The rdarray class<a class="headerlink" href="#the-rdarray-class" title="Permalink to this headline">¶</a></h2>
<p>RichDEM has a class <code class="xref cpp cpp-any docutils literal"><span class="pre">rdarray</span></code> which can wrap around NumPy arrays without copying
the memory therein. This makes it easy to pass data to RichDEM in a format it
understands.</p>
<p>The <code class="xref cpp cpp-any docutils literal"><span class="pre">rdarray</span></code> class works exactly like a NumPy array, but has some special
features.</p>
<p>Namely, an <code class="xref cpp cpp-any docutils literal"><span class="pre">rdarray</span></code> has the following properties:</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>metadata</td>
<td>A dictionary containing metadata in key-value pairs.</td>
</tr>
<tr class="row-even"><td>projection</td>
<td>A string describing the geographic projection of the dataset</td>
</tr>
<tr class="row-odd"><td>geotransform</td>
<td>An array of six floating-point values representing the size and offset of the DEM’s cells.</td>
</tr>
<tr class="row-even"><td>no_data</td>
<td>A value indicating which cell values should be treated as special NoData cells. (See Concepts, TODO)</td>
</tr>
</tbody>
</table>
<p>The <code class="xref cpp cpp-any docutils literal"><span class="pre">metadata</span></code> dictionary contains the special entry
<code class="xref cpp cpp-any docutils literal"><span class="pre">metadata['PROCESSING_HISTORY']</span></code>. This entry contains a complete list of
everything that RichDEM has done to a dataset. (See Concepts, TODO)</p>
</div>
<div class="section" id="using-richdem-without-gdal">
<h2>Using RichDEM without GDAL<a class="headerlink" href="#using-richdem-without-gdal" title="Permalink to this headline">¶</a></h2>
<p>GDAL is an optional dependency to RichDEM. In modeling, data is often stored in
NumPy arrays and evolved or manipulated without ever being loaded from or saved
to disk. To use NumPy arrays, simply wrap them with an <code class="xref cpp cpp-any docutils literal"><span class="pre">rdarray</span></code> as shown below.
Details about the <code class="xref cpp cpp-any docutils literal"><span class="pre">rdarray</span></code> are above.</p>
<p>Since an <code class="xref cpp cpp-any docutils literal"><span class="pre">rdarray</span></code> must have a <code class="xref cpp cpp-any docutils literal"><span class="pre">no_data</span></code> value and choosing the <code class="xref cpp cpp-any docutils literal"><span class="pre">no_data</span></code> value
incorrectly can produce erroneous results, RichDEM does not automagically
convert NumPy arrays. It must be done manually.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">richdem</span> <span class="kn">as</span> <span class="nn">rd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c1">#Create some NumPy data</span>
<span class="n">npa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>

<span class="c1">#Wrap the NumPy data in an rdarray. I want to treat all of the cells as data</span>
<span class="c1">#cells, so I use `no_data=-9999` since I know none of my cells will have</span>
<span class="c1">#this value.</span>
<span class="n">rda</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">rdarray</span><span class="p">(</span><span class="n">npa</span><span class="p">,</span> <span class="n">no_data</span><span class="o">=-</span><span class="mi">9999</span><span class="p">)</span>

<span class="c1">#Fill depressions, modifying in place. At this point, the calculation I</span>
<span class="c1">#wanted to do is done and I can throw away the `rda` object.</span>
<span class="n">rd</span><span class="o">.</span><span class="n">FillDepressions</span><span class="p">(</span><span class="n">rda</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cpp_api.html" class="btn btn-neutral float-right" title="RichDEM C++ Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="terrain_attributes.html" class="btn btn-neutral" title="Terrain Attributes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Richard Barnes.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.03',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>